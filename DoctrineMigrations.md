# doctrine migration generation
## version 1.0
generate by auto tool
```
bin/console doctrine:migration:diff
```
## version 1.1
Generate by auto tool
```
bin/console doctrine:migration:diff
```
change
```
$this->addSql('ALTER TABLE ambientia_queue_command ADD hash VARCHAR(64) NOT NULL...
```
to
```
$this->addSql('ALTER TABLE ambientia_queue_command ADD hash VARCHAR(64) NULL');

```
and add after that
```
$sql = 'SELECT id, service, arguments FROM ambientia_queue_command';
$hashGenerator = new \Ambientia\QueueCommand\HashGenerator($sql);
$statement = $this->connection->prepare($sql);
$statement->execute();
while ($item = $statement->fetch(PDO::FETCH_ASSOC)) {
    $this->addSql('UPDATE ambientia_queue_command SET hash=? WHERE id=?',
        [
            $hashGenerator->generate(
                $item['service'],
                unserialize($item['arguments'])
            ),
            $item['id']
        ]
    );
}
$this->addSql('ALTER TABLE ambientia_queue_command CHANGE hash hash VARCHAR(64) NOT NULL COMMENT \'Hash from service and arguments generated by HashGenerator\'');
```
__
